{% load static %}
<html>
<head>
	<meta charset="utf-8"/>
	<title>Kakao 지도 시작하기</title>
</head>
<body>
	<a href="{% url 'accounts:base'%}">메인홈페이지로</a>
	<div id="map" style="width:1000px;height:400px;"></div>
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=2f373f5b006f021ab989fa50cf097d7d"></script>
	<script>
		var container = document.getElementById('map');
		var options = {
			center: new kakao.maps.LatLng(37.5442779444, 126.9592546183),
			level: 3
		};

		var map = new kakao.maps.Map(container, options);
		
		var parks = JSON.parse("{{ parkJson|escapejs }}");
		console.log(parks)
		var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";
		for (var i = 0; i < parks.length; i++) {
  			
  			var imageSize = new kakao.maps.Size(24, 35);
 			 
  			var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize);
             
  			var marker = new kakao.maps.Marker({
    			map: map,
    			position: new kakao.maps.LatLng(parks[i].mapx, parks[i].mapy),
    			title: parks[i].title, 
    			image: markerImage 
				  });
				  
			(function(marker, place) {
				kakao.maps.event.addListener(marker, 'click', function() {
				    var iwContent='<div class="wrap">' +
						'    <div class="info">' +
						'        <div class="title">' +
						place.title +
						'        </div>' +
						'        <div class="body">' +
						'            <div class="desc">' +
						'                <div class="ellipsis">' + place.addr1 + '</div>' +
						'            </div>' +
						'        </div>' +
						'    </div>' +
						'</div>',
						iwRemoveable=true;
					var infowindow=new kakao.maps.InfoWindow({
						content:iwContent,
						removable:iwRemoveable
					});
				  
				  kakao.maps.event.addListener(marker, 'click', function() {
					infowindow.open(map,marker)
				  })
				  kakao.maps.event.addListener(map, 'click', function(mouseEvent) {
					infowindow.close()
				  })
				  
				})
			  })(marker, parks[i])
			}
	</script>
</body>
</html>